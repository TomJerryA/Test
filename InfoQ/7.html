<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /></head><body><h3>深入了解扩展的5个阶段</h3><p>Christopher Smith在上月举行的<a href="http://www.socallinuxexpo.org/scale11x/presentations/five-stages-scale">Scale11x</a>上进行了题为“<a href="http://www.socallinuxexpo.org/scale11x/presentations/five-stages-scale">扩展的五个阶段</a>”的演讲，演讲中他分享了自己对实现Web应用扩展和解决扩展中的问题的见解。Christopher举了在各阶段实现扩展的例子，同时他还对通过添加或优化良好定义的组件来改善Web应用整体扩展做了讲解。他从负载均衡讲到UDP协议的优化使用，带领听众经历了一段<a href="http://www.socallinuxexpo.org/sites/default/files/presentations/SCALE11.pdf">集知识性和娱乐性于一体的旅程</a>。</p> 
<p>最重要的基础扩展架构应具有在负载均衡器后面添加Web应用服务器的能力。负载均衡器能够通过在应用服务器间划分请求和会话的方式进行web应用的线性扩展。该技术相当于通过增加应用服务器进行线性扩展，然而这只不过是延缓了不可避免的<a href="http://www.facebook.com/pages/C10k-problem/120373131343187">C10K问题</a>，因为这种方式没有增加单个请求的响应能力。</p> 
<p>Christopher介绍了web应用前置的缓存系统如何通过处理读取操作来支持扩展：联合使用多重缓存系统使扩展最大化。Memcache服务器（或类似的服务器）可以在<a href="http://www.infoq.com/news/2007/11/cfrp;jsessionid=3A4AA3C1B677E3D0C9590D3AB79638E2">内存中存储数据从而使应用服务器能够快速检索</a>。还可以在负责均衡器之前放置反向代理为缓存的资源提供服务。最后，可以使用内容分发网络（CDN）使缓存的资源更靠近终端用户。不过缓存在写数据方面有它自身的限制。</p> 
<p>优化的持久性框架能够将扩展写入的能力带到扩展中的新阶段。Christopher认为，对大部分人来说，能够成功运用这一阶段和之前提到的内容就足够了。<a href="http://cloud.dzone.com/news/sql-vs-nosql-cloud-which">选择合适的SQL或NoSQL数据库</a>来匹配应用数据结构将显著地增强扩展性。并发读/写能力将提高写操作的吞吐量和响应能力。最后如果你能够“<a href="http://www.techopedia.com/definition/23949/atomicity-consistency-isolation-durability-acid">在ACID（特别是C和D）上</a>耍点手腕儿”，你就可以将更多的写操作提速。</p> 
<p>这些扩展技术的基础是使web应用读/写数据的延迟最小化。Christopher分享了计算机上<a href="http://norvig.com/21-days.html#answers">不同操作的延迟时间</a>：</p> 
<ul> 
 <li>L1缓存引用 - 0.5 ns</li> 
 <li>分支预测失败 – 5 ns</li> 
 <li>L2缓存引用 – 7 ns</li> 
 <li>互斥锁/解锁 – 25 ns</li> 
 <li>主内存引用 – 100 ns</li> 
 <li>使用Zippy压缩1KB – 3,000 ns</li> 
 <li>在1Gbps网络上发送1KB – 10,000 ns（0.01 ms）</li> 
 <li>从SSD随机读取4KB – 150,000 ns（0.15 ms）</li> 
 <li>从内存中顺序读取1MB – 250,000 ns（0.25 ms）</li> 
 <li>同一个数据中心内部往返 – 500,000 ns （0.5 ms）</li> 
 <li>从SSD连续读取1MB – 1,000,000 ns （1 ms）</li> 
 <li>硬盘寻道 – 10,000,000 ns （10 ms）</li> 
</ul> 
<p>Christopher演讲的其他部分涵盖了扩展的高级阶段，包括：</p> 
<ul> 
 <li>使用商用服务器传递代码而不是数据：<a href="http://www-01.ibm.com/software/data/infosphere/hadoop/mapreduce/">Map/Reduce (Hadoop)</a>，DHT（Cassandra、HBase和Riak）</li> 
 <li>通过数据分区路由数据：<a href="http://www.complexevents.com/2006/08/01/what%E2%80%99s-the-difference-between-esp-and-cep/">ESP/CEP</a>、Eigen、Storm、Esper、StreamBase和0mq等</li> 
 <li>使用UDP而不是TCP</li> 
</ul> 
<p>那些管理超大规模web应用的公司使用了最先进的技术，例如<a href="http://www.facebook.com/note.php?note_id=39391378919">Facebook使用UDP和Memcached每秒能执行成千上万次请求</a>。</p> 
<p><b>查看英文原文</b><b>：<a href="http://www.infoq.com/news/2013/03/Insight-Phases-Scaling;jsessionid=3A4AA3C1B677E3D0C9590D3AB79638E2">Insight into the Phases of Scaling</a></b></p> 
<hr /> 
<p>感谢<a href="http://www.infoq.com/cn/bycategory.action;jsessionid=3A4AA3C1B677E3D0C9590D3AB79638E2?authorName=孙镜涛">孙镜涛</a>对本文的审校。</p> 
<p>给InfoQ中文站投稿或者参与内容翻译工作，请邮件至<a href="mailto:editors@cn.infoq.com">editors@cn.infoq.com</a>。也欢迎大家通过新浪微博（<a href="http://www.weibo.com/infoqchina">@InfoQ</a>）或者腾讯微博（<a href="http://t.qq.com/infoqchina">@InfoQ</a>）关注我们，并与我们的编辑和其他读者朋友交流。</p> 
<p id="lastElm"></p><br><br><br><br><br><br></body></html>