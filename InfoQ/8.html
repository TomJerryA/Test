<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /></head><body><h3>LocalForage：引领离线时代</h3><p>Mozilla基金会发布了<a href="https://github.com/mozilla/localForage">localForage</a>，一个致力于简化web应用中离线数据存储过程的新型JavaScript库。</p>
<p>因为<a href="http://www.html5rocks.com/en/tutorials/offline/whats-offline/#toc-html5-offline-storage">可选项很多</a>，离线支持虽说不是新兴浏览器技术，也常常过于碎片化。LocalForage的独到之处在于尝试融合两方优势：用简单API实现某些新兴技术特性（异步和blob支持）。这能为web应用提供强大的离线能力，使其更接近本地移动版本，这样，开发者工作起来也会更自然。</p>
<p><a href="http://www.w3schools.com/html/html5_webstorage.asp">LocalStorage</a>是最早出现的一种可选技术，这一技术为离线存储提供了简单的数据访问功能。然而，<a href="http://calendar.perfplanet.com/2011/localstorage-read-performance/">基准测试</a>证实其速度较慢，而且只能同步使用，且无法处理二进制blob （例如，无法处理mp3文件缓存）。此后相继出现了其他两种很受欢迎的技术——<a href="https://developer.mozilla.org/en-US/docs/IndexedDB">IndexedDB</a>和<a href="http://html5doctor.com/introducing-web-sql-databases/">Web SQL</a>——异步，高效并支持大数据集。这两项技术的缺陷在于其API并不易于使用，而且都不为<a href="http://csimms.botonomy.com/2011/05/html5-storage-wars-localstorage-vs-indexeddb-vs-web-sql.html">所有主流浏览器支持</a>。</p>
<p>最近发布的localForage尝试通过技术融合来克服这些困难——既有来自IndexedDB和Web SQL的异步性和blob支持，也支持极简的localStorage语法：</p>
<pre>
var settings = {color: 'black', font: 'Helvetica'};   
localForage.setItem('settings', settings, function(result) {   
  console.log(result);   
});</pre>
<p>相比单独使用localStorage，内置的IndexedDB和Web SQL支持能让web应用存储更多数据。其API的非阻塞特性使得web应用不必因get/set调用挂起主线程，从而提高了执行效率。此外，localForage支持回调，而<a href="http://www.promisejs.org/">ES6 Promises</a> 为开发者预留了最佳实现的选择权。</p>
<p>无需手动管理（最好的驱动应独立于应用运行所依赖的浏览器进行选择），程序库就会自动装载并管理IndexedDB、Web SQL及localStorage驱动。 如果IndexedDB和Web SQL同时不可用，localForage将回退到localStorage，这样处理保证了至少基本数据都能离线存储了（尽管没有blob支持，而且速度会慢上许多）。</p>
<p>LocalForage支持所有当代浏览器。而所有浏览器都支持异步存储，括号中标注了支持localStorage的浏览器版本：</p>
<ul> 
 <li>Android Browser 2.1</li> 
 <li>BlackBerry 7</li> 
 <li>Chrome 23 (Chrome 4.0 with localStorage)</li> 
 <li>Chrome for Android 32</li> 
 <li>Firefox 10 (Firefox 3.5 with localStorage)</li> 
 <li>Firefox for Android 25</li> 
 <li>IE 10 (IE 8 with localStorage)</li> 
 <li>IE Mobile 10</li> 
 <li>Opera 15 (Opera 10.5 with localStorage)</li> 
 <li>Opera Mobile 11</li> 
 <li>PhoneGap/Apache Cordova 1.2.0</li> 
 <li>Safari 3.1</li> 
</ul>
<p><b>查看原文</b><b>链</b><b>接: </b><a href="http://www.infoq.com/news/2014/02/localforage-offline-data-web">Going Offline with LocalForage</a></p>
<hr />
<p>感谢<a href="http://www.infoq.com/cn/author/邵思华">邵思华</a>对本文的审校。</p>
<p>给InfoQ中文站投稿或者参与内容翻译工作，请邮件至<a href="mailto:editors@cn.infoq.com">editors@cn.infoq.com</a>。也欢迎大家通过新浪微博（<a href="http://www.weibo.com/infoqchina">@InfoQ</a>）或者腾讯微博（<a href="http://t.qq.com/infoqchina">@InfoQ</a>）关注我们，并与我们的编辑和其他读者朋友交流。</p><br><br><br><br><br><br></body></html>