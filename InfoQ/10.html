<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /></head><body><h3>OpenSSL Heartbleed漏洞事件记录</h3><p>2014年4月7日开始在互联网上引起轩然大波的“OpenSSL Heartbleed”漏洞是一个非常严重的漏洞，安全人士“道哥的黑板报”表示该漏洞可能成为2014年的“最佳漏洞”之一，造成的影响可能会超过去年Struts框架远程执行漏洞。</p>
<p>以下是InfoQ中文站对本次漏洞披露过程、讨论过程和影响范围的事件记录，供参考。</p>
<p>2014年4月7日，CloudFlare公司在其博客上发布了一个<a href="https://blog.cloudflare.com/staying-ahead-of-openssl-vulnerabilities">公开声明</a>，表示发现了OpenSSL 1.0.1版本当中的一个尚未被公开的漏洞，并表示CloudFlare已经在之前一周修复该bug。同日，OpenSSL官网发布该漏洞通告，漏洞标识为<a href="http://www.openssl.org/news/secadv_20140407.txt">CVE-2014-0160</a>，通告内容如下：</p>
<blockquote> 
 <p>TLS心跳扩展的处理过程漏掉了一步边界检测的步骤，这个漏洞使攻击者能够从客户端与服务器端连接的内存泄露中读取多达64KB的数据。</p> 
 <p>OpenSSL 1.0.1、1.0.1f、1.0.2-beta和1.0.2-beta1版本包含本漏洞。</p> 
 <p>Google安全组的Neel Mehta发现了本漏洞，而Adam Langley <a href="mailto:agl@chromium.org">agl@chromium.org</a> 和Bodo Moeller <a href="mailto:bmoeller@acm.org">bmoeller@acm.org</a> 提供了漏洞的补丁，感谢他们。</p> 
 <p>所有受影响的用户需尽快升级至OpenSSL 1.0.1g版本。升级有困难的用户可以通过<code>-DOPENSSL_NO_HEARTBEATS</code>选项重新编译OpenSSL进行临时修补。</p> 
 <p>1.0.2-beta2更新中将修复这个漏洞。</p> 
</blockquote>
<p>官方通告发布之后，<a href="http://www.codenomicon.com/">安全公司Codenomicon</a>单独建立网页对该漏洞进行更详细的描述与跟进，并表示其工程师在该漏洞披露之前早已单独发现了这个漏洞。由于该漏洞跟heartbeat与内存泄露的相关性，本漏洞被形象的描述为<a href="http://heartbleed.com/">Heartbleed</a>（心脏出血）。Heartbleed.com上有一份详细的FAQs，摘要部分如下：</p>
<blockquote> 
 <ul> 
  <li>这是一个非常严重的bug，导致全球互联网大量私钥和其他加密信息处于暴露的危险下。</li> 
  <li>本漏洞从2011年12月开始进入OpenSSL，并在2012年3月14日OpenSSL 1.0.1正式发布后开始大量流入市场。</li> 
  <li>Debian Wheezy、Ubuntu 12.04.4 LTS、CentOS 6.5、Fedora 18、OpenBSD 5.3、FreeBSD 10.0、NetBSD 5.0.2、OpenSUSE 12.2等发行版默认搭载了含有本漏洞的OpenSSL版本。</li> 
  <li>利用本漏洞抓取敏感信息不会留下任何痕迹。</li> 
 </ul> 
</blockquote>
<h3>社区讨论</h3>
<p>该漏洞在被公开纰漏后开始迅速传播。OpenSSL官方通告在<a href="https://news.ycombinator.com/item?id=7548468">Hacker News</a>、<a href="http://lwn.net/Articles/593683/">LWN</a>、<a href="http://www.zhihu.com/question/23328658">知乎</a>等平台上引发大量讨论，讨论方向包括：</p>
<p>吐槽OpenSSL的编码实践。造成边界检查失效的代码被视为“难以通过代码审查”，而即使是<a href="http://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=96db9023b881d7cd9f379b0c154650d6c108e9a3">修复的补丁</a>也被评价为“<a href="https://news.ycombinator.com/item?id=7552634">不忍直视</a>”：</p>
<pre>
if (1 + 2 + 16 &gt; s-&gt;s3-&gt;rrec.length) 
if (1 + 2 + payload + 16 &gt; s-&gt;s3-&gt;rrec.length) </pre>
<p>OpenBSD的<a href="http://article.gmane.org/gmane.os.openbsd.misc/211963">deraadt评价“OpenSSL的开发团队是不负责任的”</a>，还有人把2009年的一篇《<a href="https://www.peereboom.us/assl/assl/html/openssl.html">OpenSSL的开发者们都是猴子</a>》推到了Hacker News上，批评该项目的代码质量。</p>
<p>dmix写了一个脚本遍历Alexa排名前一千的网站，遍历结果显示约有30%~40%的网站包含本漏洞。他表示没有测试中国的网站，因为国内网站的443端口从国外嗅探纷纷会超时。</p>
<p>ZDNet的读者<a href="http://www.zdnet.com/heartbleed-serious-openssl-zero-day-vulnerability-revealed-7000028166/">谴责了CloudFlare</a>，认为这次造成这么大的影响很大程度上是因为CloudFlare没有走“负责任的漏洞披露过程”，在官方补丁发布之前先做了通告，而CloudFlare的工程师则坚称自己披露的时间点在OpenSSL官方通告被分享到Hacker News之后，因此没有过失。</p>
<p>@ex509 在其博客上针对本漏洞写了一篇详细的<a href="http://blog.existentialize.com/diagnosis-of-the-openssl-heartbleed-bug.html">技术分析</a>，国内的<a href="http://drops.wooyun.org/author/Fish">Fish</a>将其翻译为中文并发布在<a href="http://drops.wooyun.org/papers/1381">乌云知识库</a>。</p>
<p>知道创宇的余弦<a href="http://www.zhihu.com/question/23328658/answer/24241031">在知乎上表示</a>“@知道创宇安全研究团队 实测可以Dump出淘宝、微信、网银、陌陌、12306等各大使用OpenSSL服务的一些内存信息，里面有用户等的敏感内容（有些重要网站含明文密码）”，并表示“这事的影响超乎想象。”</p>
<p>@ZoomEye 搜索引擎制作了一份<a href="http://www.zoomeye.org/lab/openssl">受本次漏洞影响的网站地图</a>。</p>
<p>360网站卫士推出了一个<a href="http://wangzhan.360.cn/heartbleed">该漏洞的检查服务</a>，该服务技术负责人赵武<a href="http://weibo.com/2033280760/AEL3FCcoX?mod=weibotime">在微博上建议</a>“负责任的网站方没搞清楚之前还是先停服务吧。”</p>
<h3>影响范围</h3>
<p>4月8日，有大量由该bug导致的各网站漏洞被披露在Wooyun.org，包括蘑菇街、搜狗、盛大网络、UCloud、淘宝、开源中国、豌豆荚、唯品会等，各网站的工程师均在Wooyun上回应表示正在修复，部分大型网站的OpenSSL问题已经修复。</p>
<p>AWS在4月8日发布<a href="https://aws.amazon.com/security/security-bulletins/aws-services-updated-to-address-openssl-vulnerability/">升级通知</a>表示收到本漏洞影响的ELB服务器已经升级，EC2上提供的AMI已经替换为没有该漏洞的版本，同时也在帮助其Elastic Beanstalk和CloudFront的用户修复本问题。</p>
<p><a href="https://blogs.akamai.com/2014/04/heartbleed-faq-akamai-systems-patched.html">Akamai首席安全官在4月8日发布博客</a>表示已经在本漏洞公开纰漏之前完成了修复。<a href="https://blog.heroku.com/archives/2014/4/8/openssl_heartbleed_security_update">Heroku在4月8日发布修复通告</a>后提醒用户更改密码。</p>
<p>已经发布升级通告的发行版包括<a href="https://www.redhat.com/archives/rhsa-announce/2014-April/msg00017.html">红帽</a>（RHEL桌面版、服务器版、HPC、Workstation）、<a href="https://lists.fedoraproject.org/pipermail/announce/2014-April/003205.html">Fedora</a>（19、20）、<a href="http://www.ubuntu.com/usn/usn-2165-1/">Ubuntu</a>（13.10、12.10、12.04 LTS）、<a href="http://www.debian.org/security/2014/dsa-2896">Debian</a>。</p><br><br><br><br><br><br></body></html>